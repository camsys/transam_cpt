= render 'chart_scripts'

:javascript

  // Form Validations
  // override jquery validate plugin defaults
  $.validator.setDefaults({
      highlight: function(element) {
          $(element).closest('.form-group').addClass('has-error');
      },
      unhighlight: function(element) {
          $(element).closest('.form-group').removeClass('has-error');
      },
      errorElement: 'span',
      errorClass: 'help-block',
      errorPlacement: function(error, element) {
          if(element.parent('.input-group').length) {
              error.insertAfter(element.parent());
          } else {
              error.insertAfter(element);
          }
      }
  }); 
  
  // Use validation plugin to validate the forms before submittal
  $('#new_comment').validate({
    submitHandler: function(form) {
      $(form).submit();
    }
  });
  
  $(document).ready(function() {

    transam.make_same_height('.header-part');
	
    // Manage the tabs
    $('a[data-toggle="tab"]').on('shown.bs.tab', function(e) {
      // save the latest tab
      var this_tab = $(this).attr('href');
      transam.set_ui_key_value('funding_line_item_tab', this_tab);
      if (this_tab == '#chrt') {
        draw_chart();
      }
    });
      
  });
  
  $(function() {
    var last_tab = transam.get_ui_key_value('funding_line_item_tab');
    if (last_tab) {
      $('a[href='+last_tab+']').tab('show');
    } else {
      // Default to the first tab if no tab is stored
      $('a[data-toggle="tab"]:first').tab('show');
    }   
  }); 

  
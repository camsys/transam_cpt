.table-responsive
  %table.table.table-condensed.table-hover
    %thead
      %tr
        %th Name
        %th.left Sub Category
        %th.right Count
        %th.right Cost
        %th.right Requested

        %th.right Federal
        %th.right %
        %th.right State
        %th.right %
        %th.right Local
        %th.right %
        - if popup
          %th.center

    %tbody
      - project.activity_line_items.each do |ali|
        %tr{:data => {:action_path => "#{capital_project_activity_line_item_path(project, ali)}"}}

          %td.left= ali.name
          %td.center.nowrap= ali.team_ali_code
          %td.right.nowrap= format_as_integer(ali.assets.count)
          %td.right.nowrap= format_as_currency(ali.cost)
          %td.right.nowrap= format_as_currency(ali.total_funds)

          %td.right.nowrap= format_as_currency(ali.federal_funds)
          %td.right.nowrap= format_as_percentage(ali.federal_funds / ali.cost * 100.0) unless ali.federal_funds == 0

          %td.right.nowrap= format_as_currency(ali.state_funds)
          %td.right.nowrap= format_as_percentage(ali.state_funds / ali.cost * 100.0) unless ali.state_funds == 0

          %td.right.nowrap= format_as_currency(ali.local_funds)
          %td.right.nowrap= format_as_percentage(ali.local_funds / ali.cost * 100.0) unless ali.local_funds == 0

          - if popup
            %td.center
              %i.fa.fa-info-circle.text-info.popup-details{:data => {:title => "Assets", :content => "#{raw render :partial => 'activity_line_items/assets_datatable', :locals => {:ali => ali, :popup => false}}"}}

    %tfoot
      %tr
        %td{:colspan => 3}
        %td.right.nowrap= format_as_currency(project.total_cost)
        %td.right.nowrap= format_as_currency(project.total_funds)

        %td.right.nowrap= format_as_currency(project.federal_funds)
        %td
        %td.right.nowrap= format_as_currency(project.state_funds)
        %td
        %td.right.nowrap= format_as_currency(project.local_funds)
        %td
        - if popup
          %td.center

:javascript
  $('.popup-details').popover({
    trigger: 'hover',
    container: 'body',
    placement: 'left',
    animation: 'true',
    html: 'true'
  });

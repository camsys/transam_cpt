:css
  #capital_projects_table_div .fixed-table-footer {
    border-top: none;
  }

  #capital_projects_table_div .bootstrap-table .fixed-table-footer tbody>tr>td {
    padding: 0 !important;
    border: none;
  }

  .bs-bars.pull-left {
    float: none !important;
    display: inline-block;
    width: 91%;
  }

#projects_table_actions.row
  - if can? :create, CapitalProject
    = link_to new_capital_project_path, :class => 'btn btn-default', :style => 'margin-left: 5px;' do
      %i.fa.fa-plus.fa-fw
      = " New Capital Project"
  .navbar-form.pull-right{:style => 'margin-top: 0px;'}
    %button.btn.btn-primary.btn-md.dropdown-toggle{:data => {:toggle => 'dropdown'}, :style => 'vertical-align: top;'}
      %i.fa.fa-file
      = " Export"
      %span.caret
    %ul.dropdown-menu{:role => 'menu', :style => 'padding-top: 0px;'}
      %li{:style => "background-color: #f5f5f5; padding-left: 20px;  border-bottom: 1px solid black;"}
        Export Projects
      -#%li
      -#  = link_to 'CSV', current_url(format: :csv), target: '_blank', title: 'Export all rows and columns to CSV'
      -#%li
      -#  = link_to 'TXT', current_url(format: :txt), target: '_blank', title: 'Export all rows and columns to TXT'
      %li{:style => 'border-bottom: 1px solid black;'}
        = link_to 'XLSX', current_url(format: :xlsx), target: '_blank', title: 'Export all rows and columns to XLSX'
      %li{:style => "background-color: #f5f5f5; padding-left: 20px; padding-right: 20px; border-bottom: 1px solid black; border-top: 1px solid black"}
        Export Activity Line Items
      -#%li
      -#  = link_to 'CSV', current_url(format: :csv), target: '_blank', title: 'Export all rows and columns to CSV'
      -#%li
      -#  = link_to 'TXT', current_url(format: :txt), target: '_blank', title: 'Export all rows and columns to TXT'
      %li
        = link_to 'XLSX', {controller: 'capital_projects', action: 'activity_line_items', format: :xlsx}, target: '_blank', title: 'Export all rows and columns to XLSX'


:ruby
  table_dom_id = SecureRandom.hex
  show_actions ||= 0


= javascript_include_tag  "https://kit.fontawesome.com/#{ENV['FONT_AWESOME']}.js"
.library-table
  %table.elbat{:id => table_dom_id,
  :use => 'true',
  :data => {:use => 'true',
    :table_code => 'projects',
    :side => 'server',
    :current_page => '0',
    :current_page_size => '10',
    :page_sizes => "10,20,50,100",
    :search => 'server',
    :export => "['csv', 'txt', 'excel']",
    :columns => '{"project_number":{"name":"Project ID","type":"drilldown-link"},
                  "organization":{"name":"Organization"},
                  "fiscal_year":{"name":"Year"},
                  "title":{"name":"Title"},
                  "scope":{"name":"Scope"},
                  "project_type":{"name":"Project Type"},
                  "sogr":{"name":"SOGR","type":"checkmark-column"},
                  "shadow":{"name":"Shadow","type":"checkmark-column"},
                  "multi_year":{"name":"Multi-Year","type":"checkmark-column"},
                  "emergency":{"name":"Emergency Project","type":"checkmark-column"},
                  "ali":{"name":"ALI"},
                  "requested":{"name":"Requested"},
                  "allocated":{"name":"Allocated"}}',
    :selected_columns => "project_number,organization,fiscal_year,title,scope,project_type,sogr,shadow,multi_year,emergency,ali,requested,allocated",
    :cookies => 'true',
    :sort => 'server',
    :sort_params => '',
    :url => table_capital_projects_path(:format => :json) }}

:javascript
  window["#{table_dom_id}"].apply_styles = function(){
    $("##{table_dom_id} .checkmark-column .cell-text:contains('true')").each(function(){
      if($(this).children().length === 0) {
        $(this).text("").append($("<i id='checkmark' class='fa fa-check text-default'></i>"));
      }
    $("##{table_dom_id} .checkmark-column .cell-text:contains('false')").hide();
    });
  }


= render 'shared/table_formatters'




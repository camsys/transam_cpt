.panel.panel-info
  .panel-heading
    .button-group.pull-right
      %button.btn.btn-warning.btn-xs{:id => "#{asset.object_key}_edit"}
        %i.fa.fa-edit
      %button.btn.btn-primary.btn-xs{:data => {:toggle => 'collapse', :target => "##{asset.object_key}_body"}}
        %i.fa.fa-plus{:id => "#{asset.object_key}_icon"}
        
    %h3.panel-title= "#{asset.asset_subtype}: #{asset.asset_tag} #{asset.description}"
  .panel-body.collapse{:id => "#{asset.object_key}_body"}
    .row
      .col-md-6
        = format_field("Age", asset.age.to_s + " yrs")
        = format_field("Mileage", format_as_integer(asset.reported_mileage) ) if asset.type_of? :vehicle
        = format_field("Rating", format_as_decimal(asset.reported_condition_rating))
        = format_field("Policy Year", format_as_fiscal_year(asset.policy_replacement_year))
        = format_field("Scheduled Year", format_as_fiscal_year(asset.scheduled_replacement_year)) unless asset.scheduled_replacement_year.blank?
        = format_field("Scheduled Rehabilitation", format_as_fiscal_year(asset.scheduled_rehabilitation_year)) unless asset.scheduled_rehabilitation_year.blank?
      .col-md-6
        = format_field("Original Cost", format_as_currency(asset.purchase_cost))
        = format_field("Purchase Date", format_as_date(asset.purchase_date))
        = format_field("Purchased New", format_as_boolean(asset.purchased_new))
        = format_field("Est. Cost", format_as_currency(asset.estimated_replacement_cost))
    
    .row{:id => "#{asset.object_key}_form_panel"}

:javascript
  
  // Update the icons in the header based on collapsing the panels
  $('##{asset.object_key}_body').on('hide.bs.collapse', function () {
    $('##{asset.object_key}_icon').removeClass('fa-minus');
    $('##{asset.object_key}_icon').addClass('fa-plus');   
  });
  $('##{asset.object_key}_body').on('show.bs.collapse', function () {
    $('##{asset.object_key}_icon').removeClass('fa-plus');
    $('##{asset.object_key}_icon').addClass('fa-minus');   
  });  
  
  // Install a click handler for the edit form
  $('##{asset.object_key}_edit').click(function() {
    var val = '#{asset.object_key}';
    var url = '/scheduler/loader.js?id=' + val;
    transam.ajax_render_action(url, 'get');       
    $('##{asset.object_key}_form_panel').html("");
  });
  
  
  